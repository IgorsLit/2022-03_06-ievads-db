mysql> SELECT LENGTH(_utf8 '€'), CHAR_LENGTH(_utf8 '€');
+---------------------+--------------------------+
| LENGTH(_utf8 '€')   | CHAR_LENGTH(_utf8 '€')   |
+---------------------+--------------------------+
|                   3 |                        1 |
+---------------------+--------------------------+
1 row in set (0.004 sec)

mysql> SELECT INSTR('MySQL', 'SQL');
+-----------------------+
| INSTR('MySQL', 'SQL') |
+-----------------------+
|                     3 |
+-----------------------+
1 row in set (0.005 sec)

mysql> SELECT STRCMP('abc', 'def'),
    -> STRCMP('def', 'def'),
    -> STRCMP('def', 'dec');
+----------------------+----------------------+----------------------+
| STRCMP('abc', 'def') | STRCMP('def', 'def') | STRCMP('def', 'dec') |
+----------------------+----------------------+----------------------+
|                   -1 |                    0 |                    1 |
+----------------------+----------------------+----------------------+
1 row in set (0.006 sec)

mysql> SELECT CONCAT('A', '-', 'Z');
+-----------------------+
| CONCAT('A', '-', 'Z') |
+-----------------------+
| A-Z                   |
+-----------------------+
1 row in set (0.015 sec)

mysql> SELECT REVERSE('MySQL');
+------------------+
| REVERSE('MySQL') |
+------------------+
| LQSyM            |
+------------------+
1 row in set (0.003 sec)

mysql> SELECT LEFT('MySQL', 3);
+------------------+
| LEFT('MySQL', 3) |
+------------------+
| MyS              |
+------------------+
1 row in set (0.005 sec)

mysql> SELECT RIGHT('MySQL', 3);
+-------------------+
| RIGHT('MySQL', 3) |
+-------------------+
| SQL               |
+-------------------+
1 row in set (0.002 sec)

mysql> SELECT LOWER('MySQL');
+----------------+
| LOWER('MySQL') |
+----------------+
| mysql          |
+----------------+
1 row in set (0.004 sec)

mysql> SELECT UPPER('MySQL');
+----------------+
| UPPER('MySQL') |
+----------------+
| MYSQL          |
+----------------+
1 row in set (0.002 sec)

mysql> SELECT LPAD('MySQL', 8, '.');
+-----------------------+
| LPAD('MySQL', 8, '.') |
+-----------------------+
| ...MySQL              |
+-----------------------+
1 row in set (0.004 sec)

mysql> SELECT RPAD('MySQL', 8, '.');
+-----------------------+
| RPAD('MySQL', 8, '.') |
+-----------------------+
| MySQL...              |
+-----------------------+
1 row in set (0.002 sec)

mysql> SELECT TRIM('   MySQL   ') AS str;
+-------+
| str   |
+-------+
| MySQL |
+-------+
1 row in set (0.004 sec)

mysql> SELECT TRIM(LEADING 'Q' FROM 'QQQMySQLQQQ') AS str2;
+----------+
| str2     |
+----------+
| MySQLQQQ |
+----------+
1 row in set (0.002 sec)

mysql> SELECT TRIM('Q' FROM 'QQQMySQLQQQ') AS str3;
+-------+
| str3  |
+-------+
| MySQL |
+-------+
1 row in set (0.002 sec)

mysql> SELECT SUBSTRING('MySQL', 3);
+-----------------------+
| SUBSTRING('MySQL', 3) |
+-----------------------+
| SQL                   |
+-----------------------+
1 row in set (0.002 sec)

mysql> SELECT SUBSTRING('MySQL', 2, 2);
+--------------------------+
| SUBSTRING('MySQL', 2, 2) |
+--------------------------+
| yS                       |
+--------------------------+
1 row in set (0.002 sec)

mysql> SELECT SUBSTRING_INDEX('training@mysql.com', '@', 1);
+-----------------------------------------------+
| SUBSTRING_INDEX('training@mysql.com', '@', 1) |
+-----------------------------------------------+
| training                                      |
+-----------------------------------------------+
1 row in set (0.002 sec)

mysql> SELECT SUBSTRING_INDEX('www.mysql.com', '.', -2);
+-------------------------------------------+
| SUBSTRING_INDEX('www.mysql.com', '.', -2) |
+-------------------------------------------+
| mysql.com                                 |
+-------------------------------------------+
1 row in set (0.002 sec)

mysql> SELECT SUBSTRING_INDEX('www.mysql.com', '.', 2);
+------------------------------------------+
| SUBSTRING_INDEX('www.mysql.com', '.', 2) |
+------------------------------------------+
| www.mysql                                |
+------------------------------------------+
1 row in set (0.002 sec)

mysql> SELECT CURDATE(), CURTIME(), DAYNAME(NOW());
+------------+-----------+----------------+
| CURDATE()  | CURTIME() | DAYNAME(NOW()) |
+------------+-----------+----------------+
| 2022-05-22 | 17:43:12  | Sunday         |
+------------+-----------+----------------+
1 row in set (0.018 sec)

mysql> SELECT NOW(), NOW() + INTERVAL 5 DAY;
+---------------------+------------------------+
| NOW()               | NOW() + INTERVAL 5 DAY |
+---------------------+------------------------+
| 2022-05-22 17:44:31 | 2022-05-27 17:44:31    |
+---------------------+------------------------+
1 row in set (0.005 sec)

mysql> SELECT NOW(), DATE_FORMAT(NOW(), '%W the %D of %M');
+---------------------+---------------------------------------+
| NOW()               | DATE_FORMAT(NOW(), '%W the %D of %M') |
+---------------------+---------------------------------------+
| 2022-05-22 17:47:01 | Sunday the 22nd of May                |
+---------------------+---------------------------------------+
1 row in set (0.002 sec)

mysql> SELECT YEAR(NOW()), MONTH(NOW()), DAYOFMONTH(NOW()), DAY(NOW()), DAYNAME(NOW()), HOUR(NOW()), MINUTE(NOW()), SECOND(NOW());
+-------------+--------------+-------------------+------------+----------------+-------------+---------------+---------------+
| YEAR(NOW()) | MONTH(NOW()) | DAYOFMONTH(NOW()) | DAY(NOW()) | DAYNAME(NOW()) | HOUR(NOW()) | MINUTE(NOW()) | SECOND(NOW()) |
+-------------+--------------+-------------------+------------+----------------+-------------+---------------+---------------+
|        2022 |            5 |                22 |         22 | Sunday         |          17 |            51 |            28 |
+-------------+--------------+-------------------+------------+----------------+-------------+---------------+---------------+
1 row in set (0.029 sec)

mysql> -- Matematiskas funkcijas
mysql> SELECT ABS(-42), ABS(42);
+----------+---------+
| ABS(-42) | ABS(42) |
+----------+---------+
|       42 |      42 |
+----------+---------+
1 row in set (0.005 sec)

mysql> SELECT SIGN(-42), SIGN(-1), SIGN(0), SIGN(1), SIGN(42);
+-----------+----------+---------+---------+----------+
| SIGN(-42) | SIGN(-1) | SIGN(0) | SIGN(1) | SIGN(42) |
+-----------+----------+---------+---------+----------+
|        -1 |       -1 |       0 |       1 |        1 |
+-----------+----------+---------+---------+----------+
1 row in set (0.004 sec)

mysql> SELECT ROUND(135.375, 2), TRUNCATE(135.375, 2);
+-------------------+----------------------+
| ROUND(135.375, 2) | TRUNCATE(135.375, 2) |
+-------------------+----------------------+
|            135.38 |               135.37 |
+-------------------+----------------------+
1 row in set (0.002 sec)

mysql> CREATE SCHEMA funcs;
Query OK, 1 row affected (0.070 sec)

mysql> USE funcs;
Database changed
mysql> CREATE TABLE payment_copy AS SELECT * FROM sakila.payment LIMIT 5;
Query OK, 5 rows affected (0.572 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> ALTER TABLE payment_copy MODIFY COLUMN amount DECIMAL(5, 2) NULL;
Query OK, 0 rows affected (0.239 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM payment_copy LIMIT 5;
+------------+-------------+----------+-----------+--------+---------------------+---------------------+
| payment_id | customer_id | staff_id | rental_id | amount | payment_date        | last_update         |
+------------+-------------+----------+-----------+--------+---------------------+---------------------+
|          1 |           1 |        1 |        76 |   2.99 | 2005-05-25 11:30:37 | 2006-02-15 22:12:30 |
|          2 |           1 |        1 |       573 |   0.99 | 2005-05-28 10:35:23 | 2006-02-15 22:12:30 |
|          3 |           1 |        1 |      1185 |   5.99 | 2005-06-15 00:54:12 | 2006-02-15 22:12:30 |
|          4 |           1 |        2 |      1422 |   0.99 | 2005-06-15 18:02:53 | 2006-02-15 22:12:30 |
|          5 |           1 |        2 |      1476 |   9.99 | 2005-06-15 21:08:46 | 2006-02-15 22:12:30 |
+------------+-------------+----------+-----------+--------+---------------------+---------------------+
5 rows in set (0.014 sec)

mysql> UPDATE payment_copy SET amount = NULL WHERE payment_id = 3;
Query OK, 1 row affected (0.037 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM payment_copy LIMIT 5;
+------------+-------------+----------+-----------+--------+---------------------+---------------------+
| payment_id | customer_id | staff_id | rental_id | amount | payment_date        | last_update         |
+------------+-------------+----------+-----------+--------+---------------------+---------------------+
|          1 |           1 |        1 |        76 |   2.99 | 2005-05-25 11:30:37 | 2006-02-15 22:12:30 |
|          2 |           1 |        1 |       573 |   0.99 | 2005-05-28 10:35:23 | 2006-02-15 22:12:30 |
|          3 |           1 |        1 |      1185 |   NULL | 2005-06-15 00:54:12 | 2022-05-22 18:07:30 |
|          4 |           1 |        2 |      1422 |   0.99 | 2005-06-15 18:02:53 | 2006-02-15 22:12:30 |
|          5 |           1 |        2 |      1476 |   9.99 | 2005-06-15 21:08:46 | 2006-02-15 22:12:30 |
+------------+-------------+----------+-----------+--------+---------------------+---------------------+
5 rows in set (0.003 sec)

mysql> SELECT payment_id, amount*2, IFNULL(amount*2, 0) FROM payment_copy LIMIT 5;
+------------+----------+---------------------+
| payment_id | amount*2 | IFNULL(amount*2, 0) |
+------------+----------+---------------------+
|          1 |     5.98 |                5.98 |
|          2 |     1.98 |                1.98 |
|          3 |     NULL |                0.00 |
|          4 |     1.98 |                1.98 |
|          5 |    19.98 |               19.98 |
+------------+----------+---------------------+
5 rows in set (0.015 sec)

mysql> SELECT payment_id, amount*2, COALESCE(amount*2, 0) FROM payment_copy LIMIT 5;
+------------+----------+-----------------------+
| payment_id | amount*2 | COALESCE(amount*2, 0) |
+------------+----------+-----------------------+
|          1 |     5.98 |                  5.98 |
|          2 |     1.98 |                  1.98 |
|          3 |     NULL |                  0.00 |
|          4 |     1.98 |                  1.98 |
|          5 |    19.98 |                 19.98 |
+------------+----------+-----------------------+
5 rows in set (0.007 sec)

mysql> SELECT IF(1 > 0, 'YES', 'NO');
+------------------------+
| IF(1 > 0, 'YES', 'NO') |
+------------------------+
| YES                    |
+------------------------+
1 row in set (0.028 sec)

mysql> SELECT CASE 3 WHEN 1 THEN 'one'
    -> WHEN 2 THEN 'two'
    -> ELSE 'more' END;
+------------------------------------------------------------+
| CASE 3 WHEN 1 THEN 'one'
WHEN 2 THEN 'two'
ELSE 'more' END |
+------------------------------------------------------------+
| more                                                       |
+------------------------------------------------------------+
1 row in set (0.010 sec)

mysql> CREATE TABLE employees_copy AS SELECT * FROM employees.employees LIMIT 10;
Query OK, 10 rows affected (0.257 sec)
Records: 10  Duplicates: 0  Warnings: 0

mysql> SELECT emp_no,
    -> CASE gender
    -> WHEN 'M' THEN 'Viirietis'
    -> WHEN 'F' THEN 'Sieviete'
    -> ELSE 'nav zinams'
    -> END AS dzimums
    -> FROM employees_copy LIMIT 10;
+--------+-----------+
| emp_no | dzimums   |
+--------+-----------+
|  10001 | Viirietis |
|  10002 | Sieviete  |
|  10003 | Viirietis |
|  10004 | Viirietis |
|  10005 | Viirietis |
|  10006 | Sieviete  |
|  10007 | Sieviete  |
|  10008 | Viirietis |
|  10009 | Sieviete  |
|  10010 | Sieviete  |
+--------+-----------+
10 rows in set (0.014 sec)

mysql> CREATE TABLE salaries_copy AS SELECT * FROM employees.salaries LIMIT 10;
Query OK, 10 rows affected (0.243 sec)
Records: 10  Duplicates: 0  Warnings: 0

mysql> SELECT emp_no,
    -> CASE
    -> WHEN salary >70000 THEN 'virs 70 TK'
    -> WHEN salary >60000 THEN 'virs 60 TK'
    -> ELSE 'zem 60 TK'
    -> END AS category
    -> FROM salaries_copy LIMIT 10;
+--------+------------+
| emp_no | category   |
+--------+------------+
|  10001 | virs 60 TK |
|  10001 | virs 60 TK |
|  10001 | virs 60 TK |
|  10001 | virs 60 TK |
|  10001 | virs 60 TK |
|  10001 | virs 70 TK |
|  10001 | virs 70 TK |
|  10001 | virs 70 TK |
|  10001 | virs 70 TK |
|  10001 | virs 70 TK |
+--------+------------+
10 rows in set (0.014 sec)

mysql> SELECT emp_no, salary AS category FROM salaries_copy LIMIT 10;
+--------+----------+
| emp_no | category |
+--------+----------+
|  10001 |    60117 |
|  10001 |    62102 |
|  10001 |    66074 |
|  10001 |    66596 |
|  10001 |    66961 |
|  10001 |    71046 |
|  10001 |    74333 |
|  10001 |    75286 |
|  10001 |    75994 |
|  10001 |    76884 |
+--------+----------+
10 rows in set (0.007 sec)

mysql> SELECT MIN(salary), MAX(salary), AVG(salary), COUNT(salary) FROM employees.salaries;
+-------------+-------------+-------------+---------------+
| MIN(salary) | MAX(salary) | AVG(salary) | COUNT(salary) |
+-------------+-------------+-------------+---------------+
|       38623 |      158220 |  63810.7448 |       2844047 |
+-------------+-------------+-------------+---------------+
1 row in set (1 min 0.752 sec)

mysql> SELECT COUNT(*), gender FROM employees.employees GROUP BY gender;
+----------+--------+
| COUNT(*) | gender |
+----------+--------+
|   179973 | M      |
|   120051 | F      |
+----------+--------+
2 rows in set (9.718 sec)

mysql> SELECT release_year, rating, AVG(rental_duration) FROM sakila.film GROUP BY release_year, rating;
+--------------+--------+----------------------+
| release_year | rating | AVG(rental_duration) |
+--------------+--------+----------------------+
|         2006 | G      |               4.8371 |
|         2006 | PG     |               5.0825 |
|         2006 | PG-13  |               5.0538 |
|         2006 | R      |               4.7744 |
|         2006 | NC-17  |               5.1429 |
+--------------+--------+----------------------+
5 rows in set (0.184 sec)

mysql> SELECT release_year, GROUP_CONCAT(rating) AS ratingS, AVG(rental_duration) FROM sakila.film GROUP BY release_year;
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+
| release_year | ratingS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | AVG(rental_duration) |
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+
|         2006 | PG,G,NC-17,G,G,PG,PG-13,R,PG-13,NC-17,G,PG,PG,NC-17,NC-17,NC-17,R,PG-13,PG,R,R,G,R,R,G,G,NC-17,PG-13,NC-17,R,NC-17,R,PG-13,NC-17,PG-13,PG-13,PG,NC-17,G,R,PG,NC-17,G,PG-13,PG-13,G,NC-17,PG-13,R,G,NC-17,G,NC-17,R,G,G,PG-13,G,R,R,G,NC-17,PG,PG-13,PG,NC-17,PG-13,NC-17,R,NC-17,PG-13,PG,PG-13,PG,G,NC-17,G,PG,PG-13,G,PG-13,G,G,PG,G,R,NC-17,PG,G,R,PG,NC-17,PG,PG-13,G,PG-13,G,PG-13,PG,R,R,R,PG,G,NC-17,G,G,PG-13,G,NC-17,NC-17,NC-17,NC-17,NC-17,R,R,NC-17,R,G,NC-17,PG,PG,G,PG-13,NC-17,G,G,G,R,PG-13,PG,PG,NC-17,PG,R,NC-17,PG,R,PG,G,PG-13,PG,PG,PG,G,G,NC-17,R,NC-17,PG,NC-17,PG-13,G,G,PG-13,G,PG-13,R,R,PG-13,NC-17,R,PG-13,PG,G,G,NC-17,R,NC-17,PG-13,R,NC-17,PG-13,NC-17,PG-13,PG-13,R,G,G,PG-13,PG-13,G,R,PG-13,PG,NC-17,NC-17,PG,NC-17,NC-17,PG-13,R,G,PG,R,G,R,NC-17,R,PG-13,PG,G,G,PG,NC-17,G,PG,PG-13,NC-17,NC-17,PG-13,G,R,PG-13,PG,G,G,NC-17,PG-13,NC-17,R,R,NC-17,G,PG-13,G,R,PG-13,R,G,R,NC-17,PG,R,PG-13,R,G,G,G,PG-13,NC-17,R,NC-17,NC-17,R,R,G,NC-17,G,NC-17,NC-17,PG,PG-13,PG-13,NC-17,R,G,PG,NC-17,G,G,NC-17,R,G,PG,PG-13,NC-17,NC-17,R,NC-17,G,NC-17,PG,PG,PG,NC-17,PG-13,NC-17,NC-17,G,G,NC-17,NC-17,NC-17,PG-13,NC-17,R,R,G,PG,PG-13,G,G,PG-13,PG,R,G,PG-13,PG-13,PG-13,R,G,PG-13,G,PG,PG-13,NC-17,PG,R,R,PG,R,G,R,R,R,PG,G,R,PG-13,NC-17,G,R,PG-13,PG-13,NC-17,PG,NC-17,R,NC-17,NC-17,NC-17,R,NC-17,PG-13,PG,R,PG,R,PG-13,PG,R,PG,PG-13,PG,R,PG-13,PG-13,PG-13,G,PG,PG-13,NC-17,G,R,R,G,R,PG,G,NC-17,PG-13,R,NC-17,R,G,R,R,PG,R,G,R,G,PG,NC-17,G,G,NC-17,R,PG,R,PG,NC-17,R,PG-13,NC-17,G,NC-17,PG-13,R,PG-13,NC-17,PG-13,R,R,G,NC-17,NC-17,G,R,NC-17,G,PG-13,PG,NC-17,R,PG-13,R,G,PG,NC-17,G,NC-17,PG,R,R,G,PG-13,G,PG,PG-13,NC-17,PG,R,R,R,R,PG-13,R,G,G,NC-17,PG,R,PG-13,NC-17,R,NC-17,PG-13,G,PG-13,NC-17,PG,NC-17,G,PG,R,PG-13,PG-13,NC-17,NC-17,R,PG-13,PG-13,NC-17,NC-17,NC-17,NC-17,NC-17,PG-13,NC-17,NC-17,PG,PG-13,R,PG-13,G,PG,PG,R,NC-17,G,PG-13,NC-17,G,NC-17,PG,G,PG,R,PG,R,NC-17,NC-17,PG,R,PG-13,NC-17,PG-13,G,NC-17,NC-17,R,PG-13,PG,PG-13,G,R,NC-17,PG-13,R,PG-13,R,PG-13,PG-13,PG,NC-17,PG-13,NC-17,G,NC-17,PG-13,PG-13,PG-13,PG,PG,NC-17,PG,G,NC-17,NC-17,NC-17,R,PG,R,R,PG,NC-17,G,PG-13,R,PG,PG-13,PG-13,R,PG,G,PG-13,NC-17,PG-13,NC-17,G,R,R,PG-13,PG-13,PG,R,PG-13,NC-17,PG,PG,PG-13,G,PG,PG-13,PG,PG-13,G,NC-17,NC-17,PG-13,R,PG,PG-13,R,G,NC-17,G,NC-17,PG-13,PG-13,PG-13,G,G,PG,PG,PG-13,PG-13,PG-13,G,PG-13,PG-13,PG-13,G,PG,NC-17,NC-17,PG,PG,PG,PG,G,NC-17,PG,PG-13,G,G,R,PG,PG-13,PG,PG,G,PG,NC-17,PG,PG,G,R,PG,G,NC-17,PG-13,PG-13,NC-17,PG-13,PG,R,NC-17,PG-13,G,PG,PG,NC-17,G,NC-17,PG,NC-17,PG-13,G,NC-17,PG-13,NC-17,PG,PG,PG,G,PG,R,PG-13,PG-13,R,PG,PG,NC-17,NC-17,PG-13,R,G,PG-13,R,G,G,NC-17,PG,PG-13,PG-13,PG-13,PG,PG-13,PG,NC-17,PG,PG,PG-13,PG-13,PG,NC-17,PG,NC-17,PG-13,PG-13,PG,NC-17,PG-13,NC-17,G,PG,PG,PG,PG-13,NC-17,NC-17,PG-13,R,NC-17,PG,PG,PG-13,PG-13,G,PG,PG-13,PG,NC-17,G,NC-17,PG,R,PG-13,G,PG,NC-17,R,PG,R,R,NC-17,R,R,PG-13,PG,NC-17,PG,PG-13,NC-17,G,PG,NC-17,PG-13,NC-17,PG-13,R,R,PG-13,PG,R,PG,PG-13,PG-13,G,PG-13,R,PG-13,R,G,PG-13,PG-13,PG-13,NC-17,R,PG,PG-13,PG-13,NC-17,R,PG-13,R,R,NC-17,NC-17,PG,PG-13,PG,PG-13,G,G,R,G,PG,G,G,G,R,PG-13,NC-17,PG-13,PG-13,G,NC-17,PG,NC-17,NC-17,PG-13,PG,PG,G,R,PG,R,PG-13,PG,PG,PG,R,G,R,PG-13,PG-13,PG-13,PG-13,R,G,R,NC-17,R,PG,NC-17,PG-13,PG-13,PG,R,PG-13,G,PG,NC-17,R,PG-13,PG,G,PG-13,R,PG,PG-13,G,R,NC-17,PG-13,NC-17,NC-17,R,R,NC-17,PG-13,PG-13,NC-17,G,PG-13,R,PG-13,PG,R,G,PG-13,PG,PG,R,PG-13,R,PG,NC-17,NC-17,PG,NC-17,NC-17,PG,G,NC-17,R,R,NC-17,G,R,PG-13,R,PG-13,R,PG,G,R,G,R,NC-17,PG-13,NC-17,PG,PG,PG,PG-13,PG,R,G,PG,PG,PG-13,PG-13,G,PG,PG-13,PG,PG-13,PG,R,NC-17,PG-13,PG-13,PG-13,R,R,G,R,PG,PG,R,PG,G,PG-13,NC-17,R,G,PG,G,R,PG-13,PG,PG-13,G,PG-13,PG,PG-13,PG,R,PG,G,G,R,PG,G,G,PG-13,PG-13,R,PG,R,NC-17,NC-17,PG,PG-13,R,PG-13,G,NC-17,NC-17,R,NC-17,NC-17,R,R,PG-13,NC-17,PG-13,PG-13,PG-13,R,NC-17,PG-13,PG-13,NC-17,PG,PG-13,PG,PG-13,G,PG,PG-13,G,G,G,G,R,PG,PG,G,G,PG,R,G,G,NC-17,PG-13,PG-13,NC-17,R,R,R,R,R,NC-17,PG,NC-17,R,PG,NC-17,PG,NC-17,PG,R,R,PG-13,PG,NC-17,PG-13,PG-13,R,G,NC-17,NC-17,R,NC-17 |               4.9850 |
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+
1 row in set (0.202 sec)

mysql> SELECT release_year, rating, AVG(rental_duration) FROM sakila.film GROUP BY release_year, rating;
+--------------+--------+----------------------+
| release_year | rating | AVG(rental_duration) |
+--------------+--------+----------------------+
|         2006 | G      |               4.8371 |
|         2006 | PG     |               5.0825 |
|         2006 | PG-13  |               5.0538 |
|         2006 | R      |               4.7744 |
|         2006 | NC-17  |               5.1429 |
+--------------+--------+----------------------+
5 rows in set (0.112 sec)

mysql> SELECT release_year, rating, AVG(rental_duration) FROM sakila.film GROUP BY release_year, rating HAVING AVG(rental_duration) > 5;
+--------------+--------+----------------------+
| release_year | rating | AVG(rental_duration) |
+--------------+--------+----------------------+
|         2006 | PG     |               5.0825 |
|         2006 | PG-13  |               5.0538 |
|         2006 | NC-17  |               5.1429 |
+--------------+--------+----------------------+
3 rows in set (0.160 sec)

mysql> SELECT release_year, rating, AVG(rental_duration) FROM sakila.film GROUP BY release_year, rating WITH ROLLUP;
+--------------+--------+----------------------+
| release_year | rating | AVG(rental_duration) |
+--------------+--------+----------------------+
|         2006 | G      |               4.8371 |
|         2006 | PG     |               5.0825 |
|         2006 | PG-13  |               5.0538 |
|         2006 | R      |               4.7744 |
|         2006 | NC-17  |               5.1429 |
|         2006 | NULL   |               4.9850 |
|         NULL | NULL   |               4.9850 |
+--------------+--------+----------------------+
7 rows in set (0.101 sec)

mysql> exit;
